-- Updating the SCHEDULEDSTART column in the DEV_RAW.Dynamics_CRM.CRM_Appointments table
UPDATE DEV_RAW.Dynamics_CRM.CRM_Appointments
SET SCHEDULEDSTART = 
    DATEADD(hour, DATE_PART(hour, SCHEDULEDSTART), 
    DATEADD(minute, DATE_PART(minute, SCHEDULEDSTART), 
    DATEADD(second, DATE_PART(second, SCHEDULEDSTART), 
    CASE
        WHEN YEAR(SCHEDULEDSTART) < 100 THEN DATE_FROM_PARTS(2000 + YEAR(SCHEDULEDSTART), MONTH(SCHEDULEDSTART), DAY(SCHEDULEDSTART))
        ELSE SCHEDULEDSTART
    END)));

-- Selecting records to verify the update
SELECT * FROM DEV_RAW.Dynamics_CRM.CRM_Appointments
WHERE YEAR(SCHEDULEDSTART) = 2024;
